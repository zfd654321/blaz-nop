<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=750,user-scalable=no" />
<link href="css/index.css" rel="stylesheet" type="text/css" />
<script src="../../js/jquery-3.1.0.min.js"></script>
<script src="../../js/httpService.js"></script>
<script type="text/javascript"
	src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<title>体感游戏免费玩</title>
</head>

<body>

<div class="main">
<div class="text"><img src="img/text2.png"/></div>
<div class="inp"><input type="text" id="random"/></div>
<div class="sub" onclick="checkrandom()"><img src="img/sub2.png"/></div>
<div class="device"><img src="img/device2.png"/></div>
<div class="num2"><img src="img/num2.png"/></div>

</div>

<script>
var open_id = '';

$(function() {
	var code = getQueryString('code');
	sendRequest(pageContextPath+'/WXPay/getWXUserOpenId.do', {
		"code" : code
	}, function(jsonData) {
		if (jsonData.data == '1') {
			open_id = jsonData.open_id;
			payable = true;
		} else {
			alert('得到微信用户信息Error!');
		}
	});

});
function checkrandom(){
	var random_code=$("#random").val();
	sendRequest(pageContextPath+'/BLAPI/getIWantPlayAGame.do', {
		"pay_mode" : "3",
		"random_code":random_code,
		"open_id":open_id
	}, function(jsonData) {
		if (jsonData.return_code == '1') {
			alert('验证成功，请进行体验');
		} else {
			alert('验证失败，请校验后重新输入');
		}
	});
	//http://192.168.1.110:8080/BLAPIV3.0/BLAPI/getIWantPlayAGame.do?pay_mode=3&random_code=207769&open_id=XGWXGWXGW
}

function getQueryString(name) {
	var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
	var r = window.location.search.substr(1).match(reg);
	if (r != null)
		return unescape(r[2]);
	return null;
}

</script>





</body>
</html>